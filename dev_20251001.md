# BookLoop 개발 진행 상황 (2025-10-01)

## 1. 오늘 완료한 작업 내용
- DB 연동 고도화
  - 목록 API: `api/posts/list.php` 정비 (LIMIT offset,size, `condition` → `cond` 별칭, 에러 메시지 반환)
  - 상세 API: `api/posts/detail.php` 추가/개선 (`inc=1` 조회수 증가, `condition` → `cond` 별칭)
  - 등록 API: `api/posts/create.php` 성공 시 메인으로 리다이렉트(`/pages/index.html?created=1`), 폼 제출 결과 콘솔 로그
  - 과목 정규화: `LOWER(subject)`로 필터 일원화, 새로운 과목 카테고리 API(`api/posts/subjects.php`) 추가
- 프론트 연동 수정
  - data.js: 로컬 JSON 의존 제거, `fetchPosts()`, `fetchPostDetail()` 백엔드 전용으로 통일, `fetchSubjects()` 추가
  - 메인/목록(index.js/list.js):
    - DB 목록 렌더, 등록 성공 배너 표시, cond 별칭 대응
    - 가격 정렬 매핑 고정(`price_asc`/`price_desc` → `sort=price_won&order=asc|desc`)
    - 과목 셀렉트 값을 백엔드 카테고리(소문자)로 동적 채움
  - 상세(view.js): DB 상세만 사용(placeholder 이미지 제거, cond 별칭 대응)
- 경로/배포 이슈 해결
  - 글쓰기 action을 상대경로(`../api/posts/create.php`)로 변경
  - 로컬 JSON(`assets/data/posts.json`) 파일 삭제 및 참조 제거
- UX/검증 개선
  - 글쓰기 안내: “내용은 5자 이상” 표시 및 프론트 검증 추가

## 2. 현재까지 진행된 상황
- ✅ DB 연결/테이블 준비, 글 등록/목록/상세 API 동작
- ✅ 메인/목록은 DB 최신 글 표시, 등록 성공 배너 동작
- ✅ 상세는 `id` 기준으로 DB 글 표시(조회수 증가 포함)
- ✅ 과목 카테고리/필터는 소문자 기준으로 통일, 과목 셀렉트 동적 구성
- ✅ 가격 정렬(낮→높/높→낮) 매핑 정상화
- ✅ 로컬 JSON 완전 분리
- ⚠️ 댓글은 UI만 존재(백엔드 미연동)

## 3. 다음에 해야 할 작업 목록
1) 게시글 수정/삭제 API 구현 및 상세 버튼 연동(비밀번호 검증)
2) 댓글 API(생성/조회 우선) 및 상세 댓글 렌더링, 대댓글(parent_id) 구조 반영
3) 목록 컬럼(등록일/조회수) 노출 여부 확정 후 정렬 항목 동기화
4) 상세 연락 수단 문자열을 mailto/tel/오픈채팅 링크로 포맷팅
5) 에러/로딩 상태 UI 고도화(사용자 메시지 노출, 스켈레톤/스피너)
6) 캐시 무효화/헤더 점검(호스팅 환경에서 API 응답 캐시 방지 필요 시 적용)

## 4. 주의사항이나 특이사항
- 컬럼명 `condition`은 SQL 예약어 충돌 소지가 있어 API에서 `cond`로 별칭 처리(프론트 반영 완료)
- 과목 필터는 항상 소문자로 전송/비교(백엔드 `LOWER(subject)`), 과목 셀렉트도 소문자 값으로 구성
- 경로: 서브폴더 배포 시 `../api/...`/`/pages/...` 절대·상대 경로 혼용 주의
- 서버 검증: 내용 5자 이상, 가격 0 이상 정수, 비밀번호 4자 이상(등록/수정/삭제 공통)
- 보안: 비밀번호는 `password_hash/password_verify` 필수, SQL은 Prepared 사용

## 5. 프로젝트 전체 계획 요약
- 목적: 회원가입 없이 닉네임/비밀번호로 중고책 교환 글/댓글 관리, 안전거래 안내 제공
- 기술: HTML/CSS/JS + PHP(PDO, MySQL), dothome 호스팅
- 진행 단계
  1. 프론트 UI 구축(완료)
  2. DB 연동(등록/목록/상세)(완료)
  3. 댓글/수정·삭제 API(진행 예정)
  4. 반응형/접근성/UX 고도화(진행 예정)
  5. 배포/테스트/보안 점검(예정)

---
**작성일**: 2025-10-01  
**작성자**: 개발팀  
**다음 세션**: 수정/삭제·댓글 API 구현, 상세/목록 UI 보완(과목/정렬 일관성 점검)
